# Назначение
Приложение служит для тестирования ПВП-системы настольной игры "Блажь".

# Термины
Сражение -- битва между двумя или несколькими персонажами или NPC. Как минимум один персонаж участвует в сражении.
Персонаж -- участник сражения, управляемый игроком. Имеет характеристики.
NPC -- участник сражения, неигровой персонаж, управляемый искуственным интеллектом. Имеет характеристики.
Боец -- персонаж или NPC, участвующий в сражении. Может иметь поддержку.
Поддержка -- увеличение характеристик бойца во время сражения.
Характеристики (статы) -- навыки персонажа и NPC, влияющие на ход сражения. Удаль (УДА), Склизскость (СКЛ), Самонадеянность (САМ), Чуйка (ЧУЙ).
Статистика -- результат сражений. Рассчитывается для каждого персонажа. Статистика учитывает количество побед, среднее здоровье после победы.
Кубик -- элемент случайности в сражении. nДk -- результат "броска" кубика, выраженный в числовом значении, в котором n -- количество бросков кубика, значения которого могут быть от 1 до k.

# Требования
|№|Требование|Тест|
|R1|Приложение должно уметь проводить автоматические сражения персонажей|Явно не тестируется|
|R2|Должна поддерживаться возможность выбирать количество проводимых сражений|S1|
|R3|Должно поддерживаться считывание характеристик персонажей из csv и xls файлов|S2|
|R4|По окончании сражений должна быть выведена статистика|Явно не тестируется|
|R5|Должна быть возможность изменять характеристики персонажей|S3|
|R6|Должна быть возможность добавить другого персонажа в поддержку персонажу в сражении. Поддержка добавляет 1Д6+2 удали, 1Д6+2 склизскости и +10 ХП персонажу в сражении|S4|

# Правила сражения
В сражение вступают 2 бойца. Бойцы по очереди наносят друг другу удары, пока один из них не проиграет.
Очерёдность хода: нападающий проверяет свою САМ + 2Д6, обороняющийся првоеряет ЧУЙ + 2Д6. Чей результат больше, тот наносит удар первым.
При ударе атакующий проверяет свою УДА + Д6. Защищающийся проверяет свою СКЛ + Д6. Если значение атакующего больше, то ХП защищающегося уменьшается на разница между значениями. Если значение атакующего меньше, то ничего не происходит.
Критерии поражения. Для NPC -- когда ХП падает до 0 или ниже. Для Персонажа -- когда ХП падает до 5 или ниже.

Персонаж может иметь поддержку.

# Варианты использования
|№|Название|Параметры|Описание|
|1|OneToOneFightsResultQuery|firstCharacter, secondCharacter, fightsCount|Провести сражение между firstCharacter и secondCharacter fightsCount раз и вернуть статистику|
|2|CharactersQuery|filePath|Прочитать файл и взять из него персонажей и их характеристики|
|3|AddCharacterCommand|character|Добавить персонажа в файл|
|4|ChangeCharacterCommand|character|Изменить характеристики персонажа|

# Доменная модель
```plantuml
left to right direction

class Fighter<<AggregateRoot>> {
    + Id: FighterId {I}
    + Character: Character
    + HasSupport: bool
}

class Character {
    + Id: CharacterId {I, R1}
    + Prowess: int
    + Overconfidence: int
    + Slyness: int
    + Flair: int
}

class Statistics<<AggregateRoot>> {
    + StatisticsId: Id {I}
    + FirstFighterStatistics: FirstFighterStatistics
    + SecondFighterStatistics: SecondFighterStatistics
    + CountOfFights: int
}

class FighterStatistics {
    + FighterId: FighterId {I}
    + Victories: int
    + AverageHealth: double
}

Fighter "1" -- "1" Character : R1
Statistics "1" -- "2" FighterStatistics : R2

```
- `R1`: Боец содержит одного персонажа
- `R2`: Статистика содержит две статистики каждого из бойцов

# Тестирование
Из-за случайных значений, выкидываемых кубиком, усложняется тестирование программы. Для облегчения тестирования было принято решение заменить случайные значения на заранее определённые.

# Стимулы
|№|Название|Параметры|Описание|
|1|SaveCharacter|character|Создать персонажа|
|2|ChangeCharacter|character|Изменить характеристики персонажа|
|3|GetCharacter|id|Получить персонажа|
|4|GetFightResult|firstCharacter, secondCharacter, countOfFights|Получить статистику по сражению персонажей|
|5|GetAllCharacters||Получить всех персонажей|

# Тестовые цепочки
|№|Цепочка|Описание|Требование|
|1|S1|Создаются 2 персонажа;Проводится заданное количество сражений;В статистике сумма количества побед персонажей == заданному количеству сражений|R2|
|2|S2|Создать персонажа;Сохранить его;Достать из файла персонажа с тем же id; Персонажи должны быть одинаковыми|R3|
|3|S3|Создать персонажа;Изменить его храрактеристики;Достать персонажа из файла;Характеристики должны быть изменены|R5|
|4|S4|Создать персонажа 1 с УДА и СКЛ = 5 и ХП = 1; Создать второго персонажа с УДА и СКЛ = 6 и ХП = 1; Второй персонаж бьёт первым; Кубик всегда возвращает одинаковое значение; 2 тест-кейса: 1) Персонаж 1 без поддержки проигрывает 2) Персонаж 1 с поддержкой выигрывает|R6|
